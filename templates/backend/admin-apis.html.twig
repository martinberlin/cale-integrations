{% extends 'backend/backend-base.html.twig' %}

{% block body %}
    <div class="row">

        <div class="col-md-12">

            <table class="common-lists-table">
                <thead>
                </tr>
                <th>ID</th>
                <th>Name</th>
                <th title="Access Token/Auth Code (for OAuth2)">Access</th>
                <th>Created</th>
                <th title="There can be more of one Integration for API (ex. weather in Berlin / weather in Paris)">Integrations</th>
                <th>Admin</th>
                </tr>
                </thead>
                <tbody>
                {% for a in apis %}
                    <tr>
                        <td>{{ a.id }}</td>
                        <td><a title="external Documentation" href="{{ a.doc_url }}" target="_blank">[Doc]</a> {{ a.name }}</td>
                        <td>{{ a.hasToken }}</td>
                        <td>{{ a.created|date("D d.m.Y") }}</td>
                        <td>
                            {% for i in a.integrations %}
                                <div class="row">
                                    <div class="col-md-5">
                                        {% if a.edit_route != "" %}
                    <a href="{{ path(a.edit_route, {'uuid':a.userapi_id, 'intapi_uuid':i.id, 'step':2}) }}">
                        [Edit]</a>&nbsp;
                                        {% endif %}
                                        {{ i.name }}
                                    </div>
                                    <div class="col-md-7">
                                        {% if i.language %}
                                            <b>Lang:</b>{{ i.language }}&nbsp;&nbsp;
                                        {% endif %}
                                        {% if i.latitude or i.longitude %}
                                            <b>Lat:</b>{{ i.latitude|round(2, 'floor') }}&nbsp;&nbsp;
                                            <b>Long:</b>{{ i.longitude|round(2, 'floor')}}
                                        {% endif %}
                                    </div>
                                </div>
                            {% endfor %}
                            {% if a.integrations|length == 0 %}
                                No integrated
                            {% endif %}
                        </td>
                        <td>
                            {% if a.integrations|length == 0 %}
                            <a class="alert alert-info" href="{{ path(a.edit_route, {'uuid':a.userapi_id, 'step':1}) }}">
                                [Edit]
                            </a>
                            <a class="alert alert-danger" href="{{ path('b_api_delete_userapi', {'userapi_uuid':a.userapi_id}) }}">
                                [Delete]
                            </a>
                            {% endif %}

                            {% if a.edit != "" and a.url_name !="cale-google" %}
                            <a class="alert alert-success"  href="{{ a.edit }}">Configure new</a>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>

    </div>
{% endblock %}
